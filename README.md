# AI SDK Chat MML

This project is a chat interface combined with a document editor, leveraging AI capabilities.

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository-url>
    cd ai-sdk-chat-mml
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    # or
    yarn install
    ```

3.  **Set up Environment Variables:**
    *   Create a `.env.local` file in the root directory.
    *   Add the following Supabase credentials (obtain these from your Supabase project settings):
        ```env
        NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
        NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
        SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
        ```

4.  **Set up Supabase Database:**
    *   Go to your Supabase project dashboard.
    *   Navigate to the "SQL Editor".
    *   Create a "New query".
    *   Copy and paste the SQL DDL statements found in `prds/supabase_implementation.md` under the "Database Schema (SQL DDL)" section.
    *   Run the query to create the necessary tables (`folders`, `documents`, `messages`, `tool_calls`), indexes, and Row Level Security policies.

5.  **Set up Supabase Storage:**
    *   In your Supabase project dashboard, navigate to "Storage".
    *   Click "Create Bucket".
    *   Name the bucket `message_images`.
    *   **Ensure the "Public bucket" option is UNCHECKED.**
    *   Go to Bucket Settings -> Policies.
    *   Create a new policy (or edit existing) to allow authenticated users to perform the `insert` operation. Example (adjust as needed):
        *   Policy Name: `Allow Authenticated Uploads`
        *   Allowed operations: `insert`
        *   Target roles: `authenticated`
    *   *Note: Access for reading images will be handled via signed URLs generated by your application's backend.* 

6.  **Run the development server:**
    ```bash
    npm run dev
    # or
    yarn dev
    ```

7.  Open [http://localhost:3000](http://localhost:3000) with your browser.

## Project Structure (Overview)

*   `app/`: Next.js App Router directory.
    *   `api/`: Backend API routes for data fetching/mutation.
    *   `editor/[documentId]/`: Editor page component.
    *   `launch/`: Document/folder management launch page.
    *   `login/`: Authentication page.
    *   `layout.tsx`: Root layout.
    *   `globals.css`: Global styles.
*   `components/`: Reusable React components.
*   `lib/`: Utility functions, Supabase client setup.
*   `prds/`: Product Requirement Documents.
*   `public/`: Static assets.
*   `middleware.ts`: Next.js middleware for route protection.

