@tailwind base;
@tailwind components;
@tailwind utilities;

/* --- Google Font Import --- */
/* Removed Newsreader import, using local Lora font */

/* --- CSS Variables from prds/globals.txt --- */
:root {
  /* Light theme - Updated with light mode equivalents */
  --foreground-rgb: 0, 0, 0;
  --background-rgb: 246, 248, 250;  /* Cloud Mist #F6F8FA */
  --primary-color: #E5B679; /* Sunkissed Brass */
  --secondary-color: #E5B679; /* Sunkissed Brass */
  --accent-color: #FAD89D; /* Golden Sand */
  --text-color: #0F1317; /* Midnight Slate - for contrast */
  --muted-text-color: #3F4F60; /* Moonlit Azure - for readable muted text */
  --title-color: #0F1317; /* Midnight Slate - for contrast */
  --border-color: #96A2B4; /* Blue Pearl */
  --header-bg: #D9DDE2; /* Silver Fog */
  --editor-bg: #F6F8FA; /* Cloud Mist */
  --title-hover-color: #C79553; /* Golden Sand */
  --left-pane-bg: #F6F8FA; /* Cloud Mist */
  --toggle-button-bg: #D9DDE2; /* Silver Fog */
  --tab-active-bg: #D9DDE2; /* Silver Fog */
  --tab-active-border: #E5B679; /* Sunkissed Brass */
  --text-color-secondary: #96A2B4; /* Blue Pearl */
  --bg-color: #F6F8FA; /* Cloud Mist */
  --hover-bg: #D9DDE2; /* Silver Fog */
  --active-bg: #96A2B4; /* Blue Pearl */
  --input-bg: #FFFFFF; /* Keep white for inputs */
  --accent-color-light: rgba(229, 182, 121, 0.15); /* Sunkissed Brass with transparency */
  --accent-color-hover: #FAD89D; /* Golden Sand */
  --message-bg: #FFFFFF; /* White for message bubbles */
  --card-bg: #FFFFFF; /* White for cards */
  --card-bg-color-login: #0F1317; /* White for cards */
  --disabled-bg: #D9DDE2; /* Silver Fog */
  --success-bg: #ecfdf5; /* Keep existing */
  --success-text: #047857; /* Keep existing */
  --error-bg: #fef2f2; /* Keep existing */
  --error-text: #b91c1c; /* Keep existing */
  /* Additional file explorer variables */
  --bg-secondary: #F6F8FA; /* Cloud Mist */
  --bg-secondary-light: #D9DDE2; /* Silver Fog */
  --text-primary: #0F1317; /* Midnight Slate - for contrast */
  --text-secondary: #3F4F60; /* Moonlit Azure - for readable secondary text */
  --primary-color-10: rgba(229, 182, 121, 0.1); /* Sunkissed Brass with transparency */
  --danger-color: #ef4444; /* Keep existing */
  --danger-color-10: rgba(239, 68, 68, 0.1); /* Keep existing */
  --success-color: #22c55e; /* Keep existing */
  --info-color: #FAD89D; /* Golden Sand */
  --primary-color-dark: #B38A58; /* Wheat Bronze */
  /* NEW Info Notification Colors */
  --info-bg: #FEF6E7; /* Light Yellow/Orange */
  --info-text: #C77A0A; /* Dark Orange/Brown */
  --info-border: #FAD89D; /* Golden Sand */
  /* Shadow variables */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.35);
  --overlay-bg: rgba(0, 0, 0, 0.8);
  --code-bg: #f8f9fa; /* Light gray background for code blocks */
  --link-color: #C77A0A;
  --link-hover-color: #B38A58;
  /* NEW Chat Message Font Size */
  --chat-message-font-size: 0.875rem; /* Re-added using rem */
  /* NEW Chat Input Font Size */
  --chat-input-font-size: 0.875rem;

  /* Default Font Sizes for Editor and Chat - to be overridden by JS */
  --editor-font-size: 1rem;
  --chat-font-size: 1rem;

  /* Logo Filters */
  --logo-filter-light: invert(7%) sepia(15%) saturate(300%) hue-rotate(170deg) brightness(90%) contrast(100%); /* For #0F1317 from black */
  --logo-filter-dark: invert(53%) sepia(65%) saturate(328%) hue-rotate(354deg) brightness(101%) contrast(93%);    /* For #C79553 from black */
  --logo-filter: var(--logo-filter-light); /* Default to light mode filter */
}

[data-theme='dark'] {
  /* Dark theme - Based on the new color palette */
  --foreground-rgb: 255, 255, 255;
  --background-rgb: 15, 19, 23;  /* Midnight Slate #0F1317 */
  --primary-color: #C79553;  /* Ember Gold */
  --secondary-color: #C79553; /* Ember Gold */
  --title-color: #C79553; /* White */
  --accent-color: #F1C37D; /* Luminous Amber */
  --text-color: #FFFFFF; /* White */
  --muted-text-color: #A8ADB4; /* Keeping Frost Gray for readability */
  --border-color: #3F4F60; /* Moonlit Azure */
  --header-bg: #222a37; /* Steel Ash */
  --editor-bg: #0F1317; /* Midnight Slate */
  --title-hover-color: #C79553; /* Luminous Amber */
  --left-pane-bg: #0F1317; /* Midnight Slate */
  --toggle-button-bg: #2B3137; /* Steel Ash */
  --tab-active-bg: #2B3137; /* Steel Ash */
  --tab-active-border: #C79553; /* Ember Gold */
  --text-color-secondary: #8C6638; /* Burnished Bronze */
  --bg-color: #0F1317; /* Midnight Slate */
  --hover-bg: #2B3137; /* Steel Ash */
  --active-bg: #3F4F60; /* Moonlit Azure */
  --input-bg: #222a37; /* Steel Ash */
  --accent-color-light: rgba(199, 149, 83, 0.15); /* Ember Gold with transparency */
  --accent-color-hover: #F1C37D; /* Luminous Amber */
  --message-bg: #222a37; /* Steel Ash */
  --card-bg: #2B3137; /* Steel Ash */
  --disabled-bg: #3F4F60; /* Moonlit Azure */
  --success-bg: #064e3b; /* Keep existing */
  --success-text: #d1fae5; /* Keep existing */
  --error-bg: #7f1d1d; /* Keep existing */
  --error-text: #fee2e2; /* Keep existing */
  /* Additional file explorer variables */
  --bg-secondary: #0F1317; /* Midnight Slate */
  --bg-secondary-light: #2B3137; /* Steel Ash */
  --text-primary: #FFFFFF; /* White */
  --text-secondary: #A8ADB4; /* Keeping Frost Gray */
  --primary-color-10: rgba(199, 149, 83, 0.1); /* Ember Gold with transparency */
  --danger-color: #f87171; /* Keep existing */
  --danger-color-10: rgba(248, 113, 113, 0.1); /* Keep existing */
  --success-color: #4ade80; /* Keep existing */
  --info-color: #F1C37D; /* Luminous Amber */
  --primary-color-dark: #8C6638; /* Burnished Bronze */
  /* NEW Info Notification Colors */
  --info-bg: #4D381A; /* Dark Amber/Brown */
  --info-text: #F1C37D; /* Luminous Amber */
  --info-border: #F1C37D; /* Luminous Amber */
  /* Shadow variables */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.25);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.25);
  --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.35);
  --overlay-bg: rgba(0, 0, 0, 0.8);
  --code-bg: var(--input-bg); /* Use input background for code blocks in dark mode */
  --link-color: #B38A58;
  --link-hover-color: #C77A0A;

  /* Override logo filter for dark theme */
  --logo-filter: var(--logo-filter-dark);
}
/* --- End CSS Variables --- */

@font-face {
  font-family: "Lora";
  src: url("/Lora-VariableFont_wght.ttf") format("truetype");
  font-weight: 300 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "geist mono";
  src: url("/geist-mono.woff2") format("woff2");
}

/* Apply the font via the class added in the component */
.font-uncut-sans {
  font-family: 'Geist Sans', sans-serif; /* Fallback to sans-serif */
}

/* Add utility class for Lora font */
.font-newsreader {
  font-family: 'Lora', serif; /* Fallback to serif */
  font-weight: 300;
}

.typing-text,
.cursor {
  vertical-align: middle; /* Align both elements to the middle */
}
/* Block cursor styling */
.cursor {
  display: inline-block;
  width: 0.5em; /* Adjust width as needed */
  height: 1em;  /* Adjust height to match line-height/font-size */
  background-color: currentColor; /* Use text color for the block */
  margin-left: 2px; /* Optional: small space after text */
  opacity: 1; /* Start visible */
}

/* The blinking animation remains the same */
.cursor.blinking {
  animation: blink 1.2s step-end infinite;
}

@keyframes blink {
  from, to { opacity: 1; }
  50% { opacity: 0; }
}

/* Optional: Ensure h1 maintains height during typing */
/* The class h-8 (32px) was added in the component, adjust if needed */


/* --- Base Styles from prds/globals.txt --- */
* {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
  /* Do not set font-family here, let layout.tsx control it */
}

html,
body {
  max-width: 100vw;
  overflow-x: hidden;
  /* height: 100%; */ /* REMOVED: Allow body to grow naturally */
  color: rgb(var(--foreground-rgb));
  background: rgb(var(--background-rgb));
  transition: background 0.3s ease, color 0.3s ease;
  line-height: 1.5;
  /* --editor-font-size: 1rem; */ /* MOVED TO :root */
  /* --chat-font-size: 1rem;   */ /* MOVED TO :root */
  /* Do not set font-family here, let layout.tsx control it */
}

body {
  background: rgb(var(--background-rgb));
  transition: background 0.3s ease, color 0.3s ease;
}

h1, h2, h3, h4, h5, h6 {
  font-weight: 600;
  color: var(--text-color);
  margin-bottom: 0.5rem;
  line-height: 1.2;
}

h1 {
  font-size: 1.875rem; /* Tailwind text-3xl */
}

h2 {
  font-size: 1.5rem; /* Tailwind text-2xl */
}

h3 {
  font-size: 1.25rem; /* Tailwind text-xl */
}

p {
  margin-bottom: 1rem;
  color: var(--text-color);
}

/* Selection highlight styles */
::selection {
  background-color: #C79553;
  color: white;
}

[data-theme='dark'] ::selection {
  background-color: #C79553;
  color: white;
}
/* --- End Base Styles --- */

code,
pre {
  font-family: "geist mono", monospace;
}

@media (prefers-color-scheme: dark) {
  :root {
    /* Note: Dark theme variables are handled by [data-theme='dark'] above */
    /* --foreground-rgb: 255, 255, 255; */
    --background-start-rgb: 0, 0, 0;
    --background-end-rgb: 0, 0, 0;
  }
}

body {
  /* Background is now controlled by the :root/body base styles */
}

/* Add your custom component styles here */
@layer components {
  .model-select {
    /*
     You can use @apply to include Tailwind utilities.
     Example: add padding, border, and rounded corners
    */
    @apply px-4 py-2 border border-[--border-color] rounded-md bg-[--input-bg] text-[--text-color];

    /*
     Or you can write regular CSS properties if needed.
     Example: set a specific font size or background color not easily
     achieved with utilities, or style pseudo-elements like ::before/::after.
    */
    font-size: 1rem;
    /* Add more styles as needed */
  }

  /*
   You might also need styles for child elements
   or states like :focus, :hover etc.
  */
  .model-select:focus {
    @apply outline-none ring-2 ring-[--primary-color] border-[--primary-color];
  }

  /* If your model-select has specific internal elements, style them too */
  .model-select option {
    background-color: var(--input-bg); /* Use var for background */
    color: var(--text-color); /* Use var for text */
  }

  /* --- Translated Components from prds/globals.txt --- */
  .btn-primary {
    background-color: var(--primary-color);
  }
  .btn-primary:hover {
    background-color: var(--accent-color-hover);
  }

  .editor-container {
    /* Styles for the editor container */
    /* Add any specific styles here */
    /* Example: */
    /* border: 1px solid #ccc; */
    /* padding: 10px; */
  }

  /* --- End Translated Components --- */

  /* Dark mode styles */
  /* Note: Dark mode for components using CSS variables should work automatically */
  /* Keeping this media query block if needed for non-variable overrides */
  @media (prefers-color-scheme: dark) {
    .model-select {
      background-color: var(--input-bg);
      color: var(--text-color);
      border-color: var(--border-color);
    }
    /* Removed .app-header and related styles */
  }

  /* --- Custom Chat Message Text Size --- */
  .chat-message-text {
    font-size: var(--chat-font-size); /* Use CSS variable */
  }

  /* --- Custom Chat Input Text Size --- */
  .chat-input-text {
    font-size: var(--chat-font-size); /* Use CSS variable */
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* --- BlockNote Editor Custom Styles --- */
.bn-container {
  min-width: 100%;
  overflow-x: auto !important;
  max-width: 100% !important;
  height: 100%;
  padding-left: 0;
  padding-right: 0;
}

.bn-editor {
  min-width: 100%;
  /* font-size: 16px !important; */ /* Commented out or remove if exists */
  font-size: var(--editor-font-size) !important; /* Use CSS variable */
  height: 100%;
}

/* Custom BlockNote Theme Variables for Light Mode */
.bn-container[data-color-scheme="light"] {
  --bn-colors-editor-text: var(--text-color);
  --bn-colors-editor-background: var(--editor-bg);
  --bn-colors-menu-text: var(--text-color);
  --bn-colors-menu-background: var(--card-bg);
  --bn-colors-tooltip-text: var(--text-color);
  --bn-colors-tooltip-background: var(--hover-bg); /* Using hover-bg for a slightly off-white tooltip */
  --bn-colors-hovered-text: var(--text-color); /* Text on light hover background */
  --bn-colors-hovered-background: var(--hover-bg);
  --bn-colors-selected-text: var(--card-bg); /* Typically white or light text on a colored background */
  --bn-colors-selected-background: var(--primary-color);
  --bn-colors-disabled-text: var(--muted-text-color);
  --bn-colors-disabled-background: var(--disabled-bg);
  --bn-colors-shadow: var(--shadow-sm); /* Or your preferred shadow variable */
  --bn-colors-border: var(--border-color);
  --bn-colors-side-menu: var(--muted-text-color);
  /* Highlight colors can be mapped if needed, or left to BlockNote defaults */
  /* --bn-font-family: your font variable if different from body; */
  /* --bn-border-radius: your border radius variable; */
}

/* Handle text content in editor */
.bn-container p {
  white-space: pre-wrap !important;
  overflow-wrap: break-word;
  word-break: break-word;
}

/* Handle code blocks in editor */
.bn-block [data-content-type="codeBlock"] {
  overflow-x: hidden; 
  max-width: 100%; 
  min-width: auto; 
} 

/* Dark mode specific styles for BlockNote editor */
[data-theme='dark'] .bn-container {
  /* BlockNote Theme Variables for Dark Mode */
  --bn-colors-editor-text: var(--text-color);
  --bn-colors-editor-background: var(--editor-bg);
  --bn-colors-menu-text: var(--muted-text-color); /* Light gray text for non-selected menu items */
  --bn-colors-menu-background: var(--card-bg);    /* Dark background for menus */
  --bn-colors-tooltip-text: var(--text-color);      /* Light text for tooltips */
  --bn-colors-tooltip-background: var(--active-bg); /* Darker background for tooltips */
  --bn-colors-hovered-text: var(--text-color);      /* White text for hovered items */
  --bn-colors-hovered-background: var(--active-bg); /* Distinct dark hover background */
  --bn-colors-selected-text: var(--editor-bg);    /* Dark text for selected menu items (matching screenshot) */
  --bn-colors-selected-background: var(--text-color); /* Light (white) background for selected items (matching screenshot) */
  --bn-colors-disabled-text: var(--muted-text-color);
  --bn-colors-disabled-background: var(--disabled-bg);
  --bn-colors-shadow: var(--shadow-sm);
  --bn-colors-border: var(--border-color);
  --bn-colors-side-menu: var(--text-color);
  /* Highlight colors can be mapped if needed, or left to BlockNote defaults */
  /* --bn-font-family: your font variable if different from body; */
  /* --bn-border-radius: your border radius variable; */

  background-color: var(--editor-bg) !important;
  color: var(--text-color) !important;
  font-size: var(--editor-font-size); /* Added for consistency */
}

[data-theme='dark'] .bn-editor {
  background-color: var(--editor-bg) !important;
  /* font-size: 16px !important; */ /* Commented out or remove if exists */
  font-size: var(--editor-font-size) !important; /* Use CSS variable */
}

/* Ensure all BlockNote internal elements match dark theme */
[data-theme='dark'] .bn-container [contenteditable=true] {
  background-color: var(--editor-bg) !important;
  color: var(--text-color) !important;
  font-size: var(--editor-font-size); /* Added for consistency */
}

[data-theme='dark'] .bn-container [data-content-type="root"] {
  background-color: var(--editor-bg) !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* Style the toolbar and its components in dark mode */
[data-theme='dark'] .bn-container [role="toolbar"],
[data-theme='dark'] .bn-container [data-toolbar="true"] {
  background-color: var(--header-bg) !important;
  border: 1px solid var(--border-color) !important;
}

/* Style all buttons and controls in the editor for dark mode */
[data-theme='dark'] .bn-container [role="toolbar"] button,
[data-theme='dark'] .bn-container [data-toolbar="true"] button,
[data-theme='dark'] .bn-container .bn-toolbar-item {
  color: var(--text-color) !important;
  background-color: transparent !important;
  box-shadow: none !important; /* Re-apply for specificity */
  text-shadow: none !important; /* Re-apply for specificity */
  filter: none !important; /* Add this to remove potential drop-shadow */
  outline: 1px solid transparent !important; /* Ensure outline overrides defaults */
  border: none !important; /* Ensure border overrides defaults */
}

[data-theme='dark'] .bn-container [role="toolbar"] button:hover,
[data-theme='dark'] .bn-container [data-toolbar="true"] button:hover,
[data-theme='dark'] .bn-container .bn-toolbar-item:hover {
  background-color: var(--hover-bg) !important;
  box-shadow: none !important; /* Ensure no shadow on hover */
  filter: none !important;
}

/* Add focus style for accessibility */
[data-theme='dark'] .bn-container [role="toolbar"] button:focus-visible,
[data-theme='dark'] .bn-container [data-toolbar="true"] button:focus-visible,
[data-theme='dark'] .bn-container .bn-toolbar-item:focus-visible {
  outline: 1px solid var(--primary-color) !important; /* Highlight on focus */
  outline-offset: 1px !important;
  box-shadow: none !important; /* Ensure no shadow on focus */
  filter: none !important;
}

[data-theme='dark'] .bn-container [role="toolbar"] button.active,
[data-theme='dark'] .bn-container [data-toolbar="true"] button.active,
[data-theme='dark'] .bn-container .bn-toolbar-item.active {
  background-color: var(--active-bg) !important;
  box-shadow: none !important; /* Ensure no shadow when active */
  filter: none !important;
}

/* Style tooltips specifically within BlockNote for dark mode */
/* Targeting common tooltip attributes/classes - adjust if necessary */
[data-theme='dark'] .bn-container [role="tooltip"],
[data-theme='dark'] .bn-container .bn-tooltip /* Assuming a .bn-tooltip class might exist */ {
  background-color: var(--card-bg); /* Use a dark background */
  color: var(--text-color) !important; /* Use light text */
  border: 0px solid var(--border-color) !important;
  box-shadow: var(--shadow-md) !important;
  font-size: 0.8rem !important; /* Adjust font size if needed */
  padding: 2px 4px !important; /* Adjust padding if needed */
  border-radius: 4px !important; /* Add border-radius */
}

/* Make Mantine tooltip arrow transparent in dark mode */
/* [data-theme='dark'] .bn-container .mantine-Tooltip-arrow {
    background-color: transparent !important;
    border-color: transparent !important;
} */

/* Style dropdowns and menus in dark mode */
[data-theme='dark'] .bn-container [role="menu"],
[data-theme='dark'] .bn-container [role="listbox"],
[data-theme='dark'] .bn-container [data-dropdown="true"] {
  background-color: var(--card-bg) !important;
  border-color: var(--border-color) !important;
  color: var(--text-color) !important;
  box-shadow: var(--shadow-md) !important;
}

[data-theme='dark'] .bn-container [role="menuitem"],
[data-theme='dark'] .bn-container [role="option"] {
  color: var(--text-color) !important;
}

[data-theme='dark'] .bn-container [role="menuitem"]:hover,
[data-theme='dark'] .bn-container [role="option"]:hover {
  background-color: var(--hover-bg) !important;
}

/* Style code blocks in dark mode */
[data-theme='dark'] .bn-container pre,
[data-theme='dark'] .bn-container code,
[data-theme='dark'] .bn-container [data-content-type="code"] {
  background-color: var(--active-bg) !important; /* Consistent code background */
  border-color: var(--border-color) !important;
  color: var(--text-color) !important;
}

/* Make first level elements in editor align with title */
.bn-container [data-content-type="root"] > [data-content-type] {
  margin-left: 0;
  margin-right: 0;
}

/* Ensure the block elements align properly */
.bn-block {
  margin-left: 0;
  margin-right: 0;
}
/* --- End BlockNote Styles --- */

/* --- Custom Scrollbar Styling --- */
/* (Already present in prds/globals.txt, might need merging or decision if needed here) */
/*
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-color);
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-color-secondary);
}

* {
  scrollbar-width: thin;
  scrollbar-color: var(--border-color) var(--bg-color);
}
*/
/* --- End Scrollbar Styling --- */

/* --- Cubone File Manager Global Toolbar Styles --- */
.toolbar { /* Target the outer toolbar container */
  /* Apply layout styles globally */
  padding-top: 0 !important;
  padding-bottom: 0 !important;
  padding-left: 0px !important;
  padding-right: 0px !important;
  height: 46px !important; /* Match the files-container calc height */
  display: flex !important; /* Ensure content inside aligns */
  align-items: center !important; /* Vertically center content */
  justify-content: space-between !important; /* Push left/right items apart */
  /* Add width 100%? Maybe not needed if fm-toolbar handles it */
}

.fm-toolbar { /* Apply globally */
  width: 100% !important; /* Ensure it fills the container */
  display: flex !important; /* Added to ensure inner items align correctly */
  align-items: center !important; /* Added to ensure inner items align correctly */
  height: 100% !important; /* Added to ensure it fills height */
  /* Add justify-content if needed, but toolbar should handle it */
}

/* --- Cubone File Manager Dark Mode Overrides --- */
[data-theme='dark'] main.file-explorer {
  background-color: var(--bg-color) !important;
  color: var(--text-color) !important;
  border-color: var(--border-color) !important; /* Adjust if file-explorer has a border */
}

/* Remove layout styles from dark mode scope as they are now global */
/* [data-theme='dark'] .toolbar { ... } */

/* Ensure all BlockNote internal elements match dark theme */
[data-theme='dark'] .bn-container [contenteditable=true] {
  background-color: var(--editor-bg) !important;
  color: var(--text-color) !important;
}

[data-theme='dark'] .bn-container [data-content-type="root"] {
  background-color: var(--editor-bg) !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

[data-theme='dark'] .bn-container [role="toolbar"],
[data-theme='dark'] .bn-container [data-toolbar="true"] {
  background-color: var(--header-bg) !important;
  border-color: var(--border-color) !important;
}

/* Style all buttons and controls in the editor for dark mode */
[data-theme='dark'] .bn-container button,
[data-theme='dark'] .bn-container .bn-toolbar-item {
  color: var(--text-color) !important;
  background-color: transparent !important;
}

[data-theme='dark'] .bn-container button:hover,
[data-theme='dark'] .bn-container .bn-toolbar-item:hover {
  background-color: var(--hover-bg) !important;
}

[data-theme='dark'] .bn-container button.active,
[data-theme='dark'] .bn-container .bn-toolbar-item.active {
  background-color: var(--active-bg) !important;
}

/* Style dropdowns and menus in dark mode */
[data-theme='dark'] .bn-container [role="menu"],
[data-theme='dark'] .bn-container [role="listbox"],
[data-theme='dark'] .bn-container [data-dropdown="true"] {
  background-color: var(--card-bg) !important;
  border-color: var(--border-color) !important;
  color: var(--text-color) !important;
  box-shadow: var(--shadow-md) !important;
}

[data-theme='dark'] .bn-container [role="menuitem"],
[data-theme='dark'] .bn-container [role="option"] {
  color: var(--text-color) !important;
}

[data-theme='dark'] .bn-container [role="menuitem"]:hover,
[data-theme='dark'] .bn-container [role="option"]:hover {
  background-color: var(--hover-bg) !important;
}

[data-theme='dark'] .fm-toolbar { /* Target the inner toolbar div */
  background-color: var(--header-bg) !important;
  border-bottom: 1px solid var(--border-color) !important;
  /* Apply rounded corners to match container */
  border-top-left-radius: 6px; /* Match Tailwind's rounded-md */
  border-top-right-radius: 6px; /* Match Tailwind's rounded-md */
  /* width: 100%; */ /* Moved to global rule */
  /* display, align-items, height moved to global rule */
}

[data-theme='dark'] .fm-toolbar button.item-action {
  background-color: transparent !important; /* Make toolbar buttons transparent */
  color: var(--text-color) !important;
  border: none !important; /* Remove default border? */
}
[data-theme='dark'] .fm-toolbar button.item-action:hover {
  background-color: var(--hover-bg) !important;
}
[data-theme='dark'] .fm-toolbar button.item-action svg {
   color: var(--text-color) !important; /* Ensure icons inherit text color */
}

/* Style the separator */
[data-theme='dark'] .fm-toolbar .item-separator {
  background: var(--border-color) !important;
}

/* Primary Button Styling (If Needed - Check if Cubone adds a specific class like 'primary') */
/* [data-theme='dark'] .fm-toolbar button.item-action.primary { ... } */

[data-theme='dark'] section.files-container {
  /* Should inherit background from file-explorer */
}

[data-theme='dark'] div.navigation-pane {
   background-color: var(--bg-secondary) !important; /* Slightly different background for contrast? */
   border-right: 1px solid var(--border-color) !important;
}
[data-theme='dark'] div.navigation-pane .empty-nav-pane {
   color: var(--muted-text-color) !important;
}

[data-theme='dark'] .files .file-item-container {
  /* Base styles for container */
  border-radius: 4px;
  transition: background-color 0.15s ease-in-out;
}

[data-theme='dark'] .files .file-item-container:hover {
  /* Hover for non-selected */
  background-color: var(--hover-bg) !important; /* Use important to ensure override */
}

[data-theme='dark'] .files .file-item:hover {
  /* Prevent library hover on inner item */
  background-color: transparent !important;
}

[data-theme='dark'] .files .file-item-container.file-selected { /* Increased specificity */
  background-color: var(--accent-color-light) !important;
  color: var(--text-primary) !important;
}

[data-theme='dark'] .files .file-item-container.file-selected .file-item { /* Inner item when selected */
  background-color: transparent !important; /* Keep transparent */
  color: inherit !important;
}

[data-theme='dark'] .files .file-item-container.file-selected:hover { /* Increased specificity */
   background-color: var(--accent-color-light) !important; /* Keep selection color */
   color: var(--text-primary) !important;
}

[data-theme='dark'] .files .file-item-container.file-selected:hover .file-item { /* Inner item when selected & hovered */
   background-color: transparent !important; /* Keep transparent */
   color: inherit !important;
}

/* Remove or comment out the less specific rules added before */
/* 
[data-theme='dark'] .folders-preview .file-item-container.selected { ... } 
[data-theme='dark'] .folders-preview .file-item-container.selected .file-item { ... } 
[data-theme='dark'] .folders-preview .file-item-container.selected:hover { ... } 
[data-theme='dark'] .folders-preview .file-item-container.selected:hover .file-item { ... } 
*/

/* Style breadcrumb hover */
.bread-crumb-container .breadcrumb span:hover, /* Target spans within breadcrumbs */
.bread-crumb-container .folder-name:hover {   /* Target specific folder name spans */
  color: var(--link-color) !important; /* Ensure text is readable on hover */
  border-radius: 3px; /* Optional: slightly round the background */
  cursor: pointer;
}

/* Style toolbar button hover */
.fm-toolbar button.item-action:hover {
  background-color: var(--hover-bg) !important; /* Apply theme hover background */
  border-color: transparent !important; /* Remove border on hover if any */
}

/* Ensure icon color remains consistent on hover */
.fm-toolbar button.item-action:hover svg {
  color: var(--link-color) !important; /* Use standard text color for icon */
}

/* Style files list header */
.files-header {
  background-color: var(--header-bg) !important;
  color: var(--text-color) !important;
  /* Add padding or other layout styles if needed */
  /* Example: padding: 0.5rem 1rem; */
  display: flex; /* Assuming it needs flex properties like its children */
  align-items: center;
}

/* Style header columns if needed */
/* Example: 
.files-header .file-name {
  font-weight: bold;
}
*/

/* Style Toggle View Dropdown */
.toggle-view ul[role="menu"] {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px; /* Tailwind rounded-md */
  box-shadow: var(--shadow-lg);
  padding: 0.25rem 0; /* Add some vertical padding */
  min-width: 100px; /* Give it a minimum width */
}

.toggle-view li[role="menuitem"] {
  color: var(--text-color);
  background-color: transparent;
  padding: 0.5rem 1rem; /* Adjust padding as needed */
  cursor: pointer;
  display: flex; /* Align icon and text */
  align-items: center;
  gap: 0.75rem; /* Use gap between VISIBLE items */
  white-space: nowrap; /* Prevent text wrapping */
}

/* Hide the first, empty span */
.toggle-view li[role="menuitem"] > span:first-child {
  display: none;
}

/* Ensure the checkmark/icon container (second span) has consistent width for alignment */
.toggle-view li[role="menuitem"] > span:nth-child(2) {
  display: inline-flex;
  align-items: center;
  justify-content: center; /* Center the checkmark/icon */
  min-width: 18px; /* Adjust width as needed for alignment */
}

.toggle-view li[role="menuitem"]:hover {
  background-color: var(--hover-bg);
}

/* Style the checkmark icon specifically (using viewBox) */
.toggle-view li[role="menuitem"] svg[viewBox="0 0 448 512"] {
  color: var(--primary-color) !important;
  width: 13px !important; /* Match HTML */
  height: 13px !important; /* Match HTML */
}

/* Style other icons */
.toggle-view li[role="menuitem"] svg:not([viewBox="0 0 448 512"]) {
  color: var(--text-color);
  flex-shrink: 0; /* Prevent icons from shrinking */
}

/* Style sidebar folder list items */
[data-theme='dark'] .sb-folders-list-item {
  /* Add base styles if needed, e.g., transition */
  transition: background-color 0.15s ease-in-out;
  border-radius: 4px; /* Consistent rounding */
  margin: 0 0.25rem; /* Add some horizontal margin */
  padding: 0.25rem 0.5rem; /* Adjust padding */
}

[data-theme='dark'] .sb-folders-list-item:hover {
  background-color: var(--hover-bg);
  cursor: pointer;
}

[data-theme='dark'] .sb-folders-list-item.active-list-item { /* Corrected selector with dot */
  background-color: var(--accent-color-light) !important; /* Use our theme's accent color */
  color: var(--text-primary) !important; /* Use our theme's primary text color */
}

/* Ensure icons within the active item are also visible */
[data-theme='dark'] .sb-folders-list-item.active-list-item svg {
  color: var(--text-primary) !important; /* Match text color */
}

/* Keep active background on hover */
[data-theme='dark'] .sb-folders-list-item.active-list-item:hover {
  background-color: var(--accent-color-light) !important; /* Maintain active background */
}

/* Style Toggle View Dropdown */
.toggle-view ul[role="menu"] {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px; /* Tailwind rounded-md */
  box-shadow: var(--shadow-lg);
  padding: 0.25rem 0; /* Add some vertical padding */
  min-width: 100px; /* Give it a minimum width */
}

.toggle-view li[role="menuitem"] {
  color: var(--text-color);
  background-color: transparent;
  padding: 0.5rem 1rem; /* Adjust padding as needed */
  cursor: pointer;
  display: flex; /* Align icon and text */
  align-items: center;
  gap: 0.75rem; /* Use gap between VISIBLE items */
  white-space: nowrap; /* Prevent text wrapping */
}

/* Hide the first, empty span */
.toggle-view li[role="menuitem"] > span:first-child {
  display: none;
}

/* Ensure the checkmark/icon container (second span) has consistent width for alignment */
.toggle-view li[role="menuitem"] > span:nth-child(2) {
  display: inline-flex;
  align-items: center;
  justify-content: center; /* Center the checkmark/icon */
  min-width: 18px; /* Adjust width as needed for alignment */
}

.toggle-view li[role="menuitem"]:hover {
  background-color: var(--hover-bg);
}

/* Style the checkmark icon specifically (using viewBox) */
.toggle-view li[role="menuitem"] svg[viewBox="0 0 448 512"] {
  color: var(--primary-color) !important;
  width: 13px !important; /* Match HTML */
  height: 13px !important; /* Match HTML */
}

/* Style other icons */
.toggle-view li[role="menuitem"] svg:not([viewBox="0 0 448 512"]) {
  color: var(--text-color);
  flex-shrink: 0; /* Prevent icons from shrinking */
}

/* Theme-Aware Scrollbar Styles */

/* Light Theme Scrollbar */
::-webkit-scrollbar {
  width: 12px; /* Width of the scrollbar */
  height: 12px; /* Height of the scrollbar for horizontal */
}

::-webkit-scrollbar-track {
  background: var(--bg-secondary, #F6F8FA); /* Track background - use a light theme variable or fallback */
  border-radius: 6px;
}

::-webkit-scrollbar-thumb {
  background-color: var(--border-color, #96A2B4); /* Thumb color - use a light theme variable or fallback */
  border-radius: 6px;
  border: 3px solid var(--bg-secondary, #F6F8FA); /* Creates padding around thumb */
}

::-webkit-scrollbar-thumb:hover {
  background-color: var(--muted-text-color, #3F4F60); /* Thumb hover color - use a light theme variable or fallback */
}

/* Dark Theme Scrollbar */
[data-theme='dark'] ::-webkit-scrollbar-track {
  background: var(--bg-secondary, #0F1317); /* Dark track background - use a dark theme variable or fallback */
}

[data-theme='dark'] ::-webkit-scrollbar-thumb {
  background-color: var(--border-color, #3F4F60); /* Dark thumb color - use a dark theme variable or fallback */
  border-color: var(--bg-secondary, #0F1317); /* Match dark track background for border */
}

[data-theme='dark'] ::-webkit-scrollbar-thumb:hover {
  background-color: var(--muted-text-color, #A8ADB4); /* Dark thumb hover color - use a dark theme variable or fallback */
}

/* Firefox Scrollbar Styles (Less customizable but respects theme colors) */
* {
  scrollbar-width: thin; /* "auto" or "thin" */
  scrollbar-color: var(--border-color, #96A2B4) var(--bg-secondary, #F6F8FA); /* thumb track */
}

[data-theme='dark'] * {
  scrollbar-color: var(--border-color, #3F4F60) var(--bg-secondary, #0F1317); /* thumb track */
}

/* General Link Styling */
a {
  color: var(--link-color);
  text-decoration: none; /* Remove default underline */
  transition: color 0.2s ease-in-out;
}

a:hover,
a:focus {
  color: var(--link-hover-color);
  text-decoration: underline;
}

/* Specificity for Chat Markdown (if needed) */
.prose a {
  color: var(--link-color); /* Ensure prose overrides don't conflict */
  text-decoration: none;
}

.prose a:hover,
.prose a:focus {
  color: var(--link-hover-color);
  text-decoration: underline;
}



/* Custom styles for @cubone/react-file-manager */
.rename-file:focus, /* Apply to standard focus too */
.rename-file:focus-visible { /* Target focus state reliably */
  border: 1px solid transparent !important; /* Hide original border */
  outline: 2px solid var(--accent-color) !important; /* Use important to override component styles if necessary */
  outline-offset: 1px;
  border-radius: 3px; /* Optional: slightly round the outline corners */
}

/* Styles for sidebar folder list items */
[data-theme='dark'] .sb-folders-list-item {
  /* Add base styles if needed, e.g., transition */
  transition: background-color 0.15s ease-in-out;
  border-radius: 4px; /* Consistent rounding */
  margin: 0 0.25rem; /* Add some horizontal margin */
  padding: 0.25rem 0.5rem; /* Adjust padding */
}

[data-theme='dark'] .sb-folders-list-item:hover {
  background-color: var(--hover-bg);
  cursor: pointer;
}

[data-theme='dark'] .sb-folders-list-item.active-list-item { /* Corrected selector with dot */
  background-color: var(--accent-color-light) !important; /* Use our theme's accent color */
  color: var(--text-primary) !important; /* Use our theme's primary text color */
}

/* Ensure icons within the active item are also visible */
[data-theme='dark'] .sb-folders-list-item.active-list-item svg {
  color: var(--text-primary) !important; /* Match text color */
}

/* Keep active background on hover */
[data-theme='dark'] .sb-folders-list-item.active-list-item:hover {
  background-color: var(--accent-color-light) !important; /* Maintain active background */
}

/* Style breadcrumb hover */
.bread-crumb-container .breadcrumb span:hover, /* Target spans within breadcrumbs */
.bread-crumb-container .folder-name:hover {   /* Target specific folder name spans */
  color: var(--link-color) !important; /* Ensure text is readable on hover */
  border-radius: 3px; /* Optional: slightly round the background */
  cursor: pointer;
}

/* Style toolbar button hover */
.fm-toolbar button.item-action:hover {
  background-color: var(--hover-bg) !important; /* Apply theme hover background */
  border-color: transparent !important; /* Remove border on hover if any */
}

/* Ensure icon color remains consistent on hover */
.fm-toolbar button.item-action:hover svg {
  color: var(--link-color) !important; /* Use standard text color for icon */
}

/* Style files list header */
.files-header {
  background-color: var(--header-bg) !important;
  color: var(--text-color) !important;
  /* Add padding or other layout styles if needed */
  /* Example: padding: 0.5rem 1rem; */
  display: flex; /* Assuming it needs flex properties like its children */
  align-items: center;
}

/* Style header columns if needed */
/* Example: 
.files-header .file-name {
  font-weight: bold;
}
*/

/* Style Toggle View Dropdown */
.toggle-view ul[role="menu"] {
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px; /* Tailwind rounded-md */
  box-shadow: var(--shadow-lg);
  padding: 0.25rem 0; /* Add some vertical padding */
  min-width: 100px; /* Give it a minimum width */
}

.toggle-view li[role="menuitem"] {
  color: var(--text-color);
  background-color: transparent;
  padding: 0.5rem 1rem; /* Adjust padding as needed */
  cursor: pointer;
  display: flex; /* Align icon and text */
  align-items: center;
  gap: 0.75rem; /* Use gap between VISIBLE items */
  white-space: nowrap; /* Prevent text wrapping */
}

/* Hide the first, empty span */
.toggle-view li[role="menuitem"] > span:first-child {
  display: none;
}

/* Ensure the checkmark/icon container (second span) has consistent width for alignment */
.toggle-view li[role="menuitem"] > span:nth-child(2) {
  display: inline-flex;
  align-items: center;
  justify-content: center; /* Center the checkmark/icon */
  min-width: 18px; /* Adjust width as needed for alignment */
}

.toggle-view li[role="menuitem"]:hover {
  background-color: var(--hover-bg);
}

/* Style the checkmark icon specifically (using viewBox) */
.toggle-view li[role="menuitem"] svg[viewBox="0 0 448 512"] {
  color: var(--primary-color) !important;
  width: 13px !important; /* Match HTML */
  height: 13px !important; /* Match HTML */
}

/* Style other icons */
.toggle-view li[role="menuitem"] svg:not([viewBox="0 0 448 512"]) {
  color: var(--text-color);
  flex-shrink: 0; /* Prevent icons from shrinking */
}

[data-theme='dark'] main.file-explorer div.folders-preview { /* Increased specificity */
  background-color: var(--bg-color) !important;
  color: var(--text-color) !important;
}

/* Parallax Background Styles - CSS Fixed Attachment */
.parallax-bg {
  position: relative; /* Still useful if child elements need absolute positioning relative to main */
  background-color: var(--bg-color); /* Base background */

  /* Background properties - Moved from ::before */
  background-image: url('/tuon-bg.png');
  background-position: center center;
  background-repeat: no-repeat;
  background-size: cover;
  background-attachment: fixed; /* Key property for CSS parallax */

  /* Removed properties related to JS/pseudo-element approach */
  /* --background-offset-y: 0px; */
  /* z-index: 100; */ 
}

/* REMOVED ::before pseudo-element rule */
/*
.parallax-bg::before {
  content: "";
  position: absolute; 
  left: 0;
  right: 0;
  top: 0; 
  height: 150%; 
  z-index: -1; 
  background-image: url('/tuon-bg.png');
  background-position: center center;
  background-repeat: no-repeat;
  background-size: cover;
  transform: translateY(var(--background-offset-y)) scale(1.1);
  will-change: transform;
}
*/

/* Remove the old direct styles */
/*
.parallax-bg {
// ... existing code ...

}
*/

/* Feature Card Scroll Animation Styles */
.feature-card {
  opacity: 0;
  transform: translateY(30px); /* Start slightly lower */
  transition: opacity 0.6s ease-out, transform 0.6s ease-out, border-color 0.3s ease-in-out;
}

.feature-card.is-visible {
  opacity: 1;
  transform: translateY(0);
}

/* Subtle hover effect for visible cards */
.feature-card.is-visible:hover {
  transform: translateY(-4px); /* Slight lift */
  border-color: var(--accent-color); /* Highlight border with accent color */
  cursor: default; /* Indicate it's not clickable unless it is */
}

/* Scroll Snapping - TEMPORARILY DISABLED FOR DEBUGGING */
/*
html {
  scroll-snap-type: y mandatory; 
}

.card-snap-wrapper {
  scroll-snap-align: start; 
}
*/

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 222.2 84% 4.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
  }
  [data-theme="dark"] {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* --- Pinned Message Bubble Styles --- */
.pinned-message-bubble {
    @apply absolute bottom-full left-0 right-0 mb-2; /* Positioning, added left/right padding (4 = 1rem) */
    @apply z-10; /* Ensure it's above editor content but below modals/popovers */
    @apply p-2; /* Adjusted padding (p-2 -> 8px) */
    @apply rounded-md border; /* Use theme radius and border */
    @apply flex items-center justify-between gap-2; /* Layout */
    @apply text-sm; /* Slightly larger than follow-up */
    /* Use CSS vars for theme awareness */
    @apply bg-[--info-bg] text-[--info-text] border-[--info-border] dark:border-[--border-color];
}

/* Utility for line clamping (if not globally available) */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

@media (max-width: 768px) {
  .parallax-bg {
    background-image: url('/tuon-bg-small.png');
    background-attachment: scroll !important;
    background-size: cover;
    background-position: center;
  }
}

/* Basic Markdown Element Styling */
/* Applied globally to ensure elements rendered by ReactMarkdown are styled */

strong, b { /* For **bold** text */
  font-weight: bold;
}

em, i { /* For *italic* text */
  font-style: italic;
}

/* Unordered lists */
ul {
  list-style-type: disc;
  margin-left: 1.5rem; /* Indentation for the list itself */
  padding-left: 0.5rem; /* Inner padding for bullet alignment */
  margin-bottom: 1rem; /* Consistent with <p> tags */
}

/* Ordered lists */
ol {
  list-style-type: decimal;
  margin-left: 1.5rem; /* Indentation for the list itself */
  padding-left: 0.5rem; /* Inner padding for number alignment */
  margin-bottom: 1rem; /* Consistent with <p> tags */
}

/* Nested lists - provide some spacing */
ul ul, ul ol, ol ol, ol ul {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
}

/* List items */
li {
  margin-bottom: 0.25rem; /* Spacing between list items */
}

/* Paragraphs within the markdown content (ReactMarkdown often wraps lines in <p>) */
/* This ensures they also get consistent bottom margin if not already applied */
.prose p, /* If we ever re-introduce prose, this helps */
div > p, /* General paragraphs that might be output by ReactMarkdown */
span > p { /* Or if wrapped in spans */
  margin-bottom: 0.75rem; /* Slightly less than default p for tighter notes */
}
/* End Basic Markdown Element Styling */

/* AI Action Toast - Outline pulse animation for highlighting blocks */
@keyframes outline-pulse {
  0%, 100% {
    outline: 2px solid transparent;
  }
  50% {
    outline: 2px solid var(--accent-color);
  }
}

.outline-pulse {
  animation: outline-pulse 1s ease-in-out;
}

/* Toast slide-in animations */
@keyframes slide-in-from-right {
  0% { 
    transform: translateX(100%);
    opacity: 0;
  }
  100% { 
    transform: translateX(0);
    opacity: 1;
  }
}

.slide-in-from-right {
  animation: slide-in-from-right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}